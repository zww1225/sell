<template>
  <div class="nav">
    <h4 class="imgs">
      <svg
        t="1597400816599"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="4785"
        width="32"
        height="32"
      >
        <path
          d="M943.104 463.36c-1.536 14.336-3.072 28.16-5.12 42.496-11.776 81.92-44.544 154.624-98.816 217.088-70.656 81.92-159.744 132.608-267.264 146.432-146.944 18.944-272.896-25.6-375.296-133.12-64.512-67.584-100.864-149.504-112.64-242.176-2.048-14.848-2.048-29.696-2.56-44.544 0-2.048 0-3.584 0.512-6.144 3.584 0 6.144-0.512 9.216-0.512h851.968v20.48zM509.44 72.704c1.536 1.536 3.072 4.096 5.12 5.12 14.848 7.68 18.432 21.504 20.48 36.352 0.512 3.072-1.024 6.144-1.536 8.704 0 1.024-1.024 1.536-1.536 2.56-23.552 28.16-17.408 55.296 1.024 82.944 14.336 22.016 29.696 43.52 35.328 70.656 6.656 33.792-1.024 64-24.576 88.576-6.656 7.168-18.432 12.288-28.16 12.8-7.68 0.512-16.896-5.632-24.064-10.752-8.192-5.632-12.288-26.624-9.216-36.352 3.584-12.8 7.168-25.6 10.24-38.4 1.024-3.584 0-8.192-2.048-11.264-13.312-25.088-27.136-50.176-40.448-75.776-20.48-38.912-16.896-81.408 15.872-114.176 12.288-12.288 27.136-15.872 41.984-20.992h1.536z m-181.248 0c1.536 1.536 3.072 4.096 5.12 5.12 14.848 7.68 18.432 21.504 19.968 36.352 0.512 3.584-0.512 7.68-2.56 10.24-23.552 28.672-17.92 56.32 1.536 84.992 14.336 21.504 29.696 43.008 34.816 69.632 6.656 33.792-1.024 64-24.576 88.576-6.656 7.168-18.432 12.288-28.16 12.8-7.68 0.512-16.896-5.632-24.064-10.752-8.192-5.632-12.288-26.624-9.216-36.352 4.096-12.8 7.168-25.6 10.24-38.4 1.024-3.584 0-8.192-2.048-11.264-13.312-25.088-27.136-50.176-40.448-75.776-20.48-38.912-16.896-81.408 15.872-114.176 12.288-12.288 27.136-15.872 41.984-20.992h1.536z m362.496 0c1.536 1.536 3.072 4.096 5.12 5.12 14.848 7.68 18.432 21.504 20.48 36.352 0.512 3.072-0.512 6.144-1.536 8.704-0.512 1.536-1.536 3.072-2.56 4.096-22.528 27.136-16.384 52.736 1.024 79.872 14.848 22.528 30.72 44.544 36.352 72.192 6.656 33.792-1.024 64-24.576 88.576-6.656 7.168-18.432 12.288-28.16 13.312-7.68 0.512-16.896-5.632-24.576-10.24-8.192-5.632-12.8-26.624-9.216-36.352 2.56-7.168 4.608-14.848 7.168-22.016 8.192-22.016-3.072-39.936-11.776-57.856-4.608-9.216-10.752-17.408-15.872-26.112-10.752-16.896-21.504-34.816-22.528-55.296-1.024-13.824-0.512-28.16 3.072-40.96 6.144-20.48 21.504-36.352 37.888-49.664 4.096-3.072 9.728-3.584 14.848-5.12 4.096-1.536 8.704-2.56 13.312-4.096 0.512-0.512 1.024-0.512 1.536-0.512z"
          fill="#EB4237"
          p-id="4786"
        />
        <path
          d="M266.752 815.104c-22.528 8.704-45.056 16.896-67.072 25.6 0 1.536 0 2.56 0.512 4.096 13.312 5.632 26.624 11.776 40.448 16.384 45.056 15.36 92.16 23.04 139.264 28.672 55.296 6.656 111.104 8.704 166.912 6.656 78.336-2.048 156.16-10.24 231.936-34.304 15.36-4.608 30.208-11.776 47.616-18.432-23.552-14.336-46.592-20.48-70.144-27.648 1.536-2.048 2.56-3.072 4.096-4.096 15.872-12.288 31.744-24.064 47.104-36.864 4.096-3.584 7.68-5.12 12.8-2.048 16.896 9.216 34.304 17.408 50.688 27.648 11.776 7.68 20.48 17.92 25.088 32.256 4.096 13.824 0.512 24.576-7.168 34.816-11.776 16.384-29.184 26.112-46.592 34.816-41.472 20.48-86.016 31.232-131.072 38.912-86.016 15.36-172.544 19.456-259.584 14.848-76.288-3.584-152.064-12.288-224.768-36.352-23.552-7.68-45.568-19.456-67.584-31.232-8.704-4.608-15.872-12.8-23.04-19.968-13.824-14.848-11.776-37.376 1.536-53.248 18.944-22.528 44.544-33.28 70.144-44.032 1.536-0.512 4.608 0 5.632 1.024 17.92 13.824 35.328 27.648 52.736 41.472 0.512 0 0.512 1.024 0.512 1.024z"
          fill="#EB4237"
          p-id="4787"
        />
      </svg>外卖后台管理系统
    </h4>
    <el-menu
      unique-opened
      :default-active="curactive"
      @open="handleOpen"
      @close="handleClose"
      background-color="#17324D"
      text-color="#fff"
      active-text-color="#F04567"
      router
    >
      <!-- 没儿子 -->
      <div v-for="item in newList" :key="item.name">
        <!-- 后台首页 -->
        <el-menu-item default-active v-if="!item.children" :index="item.url">
          <i :class="item.icon"></i>
          <span slot="title">{{item.name}}</span>
        </el-menu-item>
      </div>

      <!-- 有儿子 -->

      <div v-for="item in newList" :key="item.name">
        <el-submenu v-if="item.children" :index="item.url">
          <template slot="title">
            <i :class="item.icon"></i>
            <span>{{item.name}}</span>
          </template>
          <el-menu-item-group>
            <el-menu-item
              v-for="child in item.children"
              :key="child.name"
              :index="child.url"
            >{{child.name}}</el-menu-item>
          </el-menu-item-group>
        </el-submenu>
      </div>
    </el-menu>
  </div>
</template>

<script>
export default {
  data() {
    return {
      list: [
        {
          url: "/home",
          icon: "el-icon-menu",
          name: "后台首页",
          roles: ["super", "normal"],
        },
        {
          url: "/order",
          icon: "el-icon-document",
          name: "订单管理",
          roles: ["super", "normal"],
        },
        {
          url: "/goods",
          icon: "el-icon-goods",
          name: "商品管理",
          children: [
            { url: "/goods-list", name: "商品列表" },
            { url: "/add-goods", name: "商品添加" },
            { url: "/cate-goods", name: "商品分类" },
          ],
          roles: ["super", "normal"],
        },
        {
          url: "/shop",
          icon: "el-icon-s-home",
          name: "店铺管理",
          roles: ["super"],
        },
        {
          url: "/account",
          icon: "el-icon-s-custom",
          name: "账号管理",
          children: [
            { url: "/account-list", name: "账号列表" },
            { url: "/add-account", name: "添加账号" },
            { url: "/edit-pass", name: "修改密码" },
          ],
          roles: ["super"],
        },
        {
          url: "/total",
          icon: "el-icon-pie-chart",
          name: "销售统计",
          children: [
            { url: "/shop-total", name: "商品统计" },
            { url: "/order-total", name: "订单统计" },
          ],
          roles: ["super"],
        },
      ],
      curactive: "",
    };
  },
  created() {
    // console.log(this.$route);
    this.curactive = this.$route.path;
  },
  methods: {
    handleOpen(key, keyPath) {
      // console.log(key, keyPath);
    },
    handleClose(key, keyPath) {
      // console.log(key, keyPath);
    },
  },
  computed: {
    // 根据登录进来的role，计算菜单
    newList() {
      return this.list.filter((item) => item.roles.includes(localStorage.role));
    },
  },
};
</script>

<style lang="less" scoped>
.nav {
  flex: 0 0 200px;
  .imgs {
    // width: 50px;
    // height: 50px;
    margin-left: 10px;
    margin-top: 10px;
    display: flex;
    align-items: center;
    color: white;
  }
  .el-menu {
    // height: 100%;
    border: 0px;
  }

  // width: 200px;
  height: 100%;
  background-color: #17324d;
}
</style>